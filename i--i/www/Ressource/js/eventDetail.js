// Generated by CoffeeScript 1.8.0
(function() {
  angularApp.service("eventDetailService", [
    "$q", function($q) {
      return {
        loadData: function() {
          return $q(function(resolve, reject) {
            var init, subHandler;
            init = function(data) {
              fw.pubsub.unsubscribe("/eventDetail", subHandler);
              return resolve(data);
            };
            subHandler = fw.pubsub.subscribe("/eventDetail", init, true);
            return fw.pubsub.publish("documentReady", "/eventDetail");
          });
        }
      };
    }
  ]);

  angularApp.controller("eventDetailController", [
    "$scope", "$timeout", "$ionicTabsDelegate", "eventDetailResolver", function($scope, $timeout, $ionicTabsDelegate, eventDetailResolver) {
      $scope.event = eventDetailResolver.event;
      $timeout((function(_this) {
        return function() {
          return $ionicTabsDelegate.select(1);
        };
      })(this), 100);
      $scope.close = function() {
        return fw.goToPage(eventDetailResolver.backTo, {});
      };
      $scope.imageStyle = function(image) {
        var height, maxSize, width;
        maxSize = 380;
        width = 0;
        height = 0;
        if (image.width > image.height) {
          width = maxSize;
          height = Math.round(maxSize * (image.height / image.width));
        } else {
          height = maxSize;
          width = Math.round(maxSize * (image.width / image.height));
        }
        return {
          "width": width,
          "height": height
        };
      };
      return $scope.showImage = function(index) {
        var images;
        images = $scope.event.images;
        return fw.goToPage("/imageViewer", {
          "images": images,
          "index": index,
          "backTo": "/eventDetail"
        });
      };
    }
  ]);

}).call(this);
